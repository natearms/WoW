<!DOCTYPE html>
<html>
<head>
    <!--https://stackoverflow.com/questions/19797064/show-hide-table-rows-using-javascript-classes-->
    <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script type="text/javascript">
        function customerOrderData() {
            var custNbr = "67865";
            var orderNbr = "15-P-24347";
            var brand = "50";

            var table = document.getElementById("customerOrders");
            
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 &&
                    this.status == 200) {
                    var results = JSON.parse(this.responseText);


                    for (var i = 0; i < results.CustOrders.length; i++) {
                        var newRow = table.insertRow(i + 1);

                        var cell1 = newRow.insertCell(0);
                        var cell2 = newRow.insertCell(1);
                        var cell3 = newRow.insertCell(2);
                        var cell4 = newRow.insertCell(3);
                        var cell5 = newRow.insertCell(4);

                        cell1.innerHTML = "<a href=\"#\" class=\"toggler\" data-orderDetails=\"" + i + "\">+";
                        cell2.innerHTML = "" + results.CustOrders[i]["ORDERNUMBER"] + "</br>" + results.CustOrders[i]["PROJECTNAME"];
                        cell3.innerHTML = results.CustOrders[i]["ORDERISFOR"];
                        cell4.innerHTML = results.CustOrders[i]["Status"];
                        cell5.innerHTML = results.CustOrders[i]["ReceivedDate"];


                    }
                    return myObj;
                }
            };
            xmlhttp.open("GET", "https://nextgen-crmapi.ncigroupwstest.com/api/GetCustomerOrders/" + custNbr + "/" + brand + "", true);
            xmlhttp.send();

        }
    </script>
    <script type="text/javascript">
        function customerOrderDataTest() {
            var custNbr = "67865";
            var orderNbr = "15-P-24347";
            var brand = "50";

            var table = document.getElementById("customerOrders");
            var customerOrderJSON = '{ "CustOrders": [{ "ORDERNUMBER": "15-P-92710", "Status": "ACTIVE", "PROJECTNAME": "Walk door to match 15-B-15025", "ReceivedDate": "2017-08-08T14:57:10", "Revision": 0, "CUSTOMERPO": null, "ORDERISFOR": "FABRICATION", "CREDITAPPROVAL": "YES", "SHIPBY": null, "CustomerServiceLocation": "50", "CUSTOMERSERVICERELEASEDATE": "08/08/2017", "ENGINEERINGRELEASEDATE": null, "Contact": "JOHN WANTA", "PHONE": "715-454-6222", "JOBSITESHIPPINGCONTACT": "John Wanta", "JOBSITESHIPPINGPHONE": "715-340-3085", "CUSTOMERNUMBER": "67865", "PHASE": "01", "ABDATE": null, "DWGDATE": null, "SHIPWEEK": "08/23/2017", "XDARELEASEDATE": null, "TOTALPRICE": 882.75, "COMPANYNAME": "KWATERSKI BROS. WOOD PRODUCTS", "COMPANYADDRESS": "435 US HIGHWAY 45 S", "Address2": null, "Address3": null, "Address4": null, "COMPANYCITY": "THREE LAKES", "COMPANYSTATE": "WI", "COMPANYZIP": "54562", "COMPANYCOUNTRY": "US" }, { "ORDERNUMBER": "15-P-92710", "Status": "ACTIVE", "PROJECTNAME": "Walk door to match 15-B-15025", "ReceivedDate": "2017-08-08T14:57:10", "Revision": 0, "CUSTOMERPO": null, "ORDERISFOR": "FABRICATION", "CREDITAPPROVAL": "YES", "SHIPBY": null, "CustomerServiceLocation": "50", "CUSTOMERSERVICERELEASEDATE": "08/08/2017", "ENGINEERINGRELEASEDATE": null, "Contact": "JOHN WANTA", "PHONE": "715-454-6222", "JOBSITESHIPPINGCONTACT": "John Wanta", "JOBSITESHIPPINGPHONE": "715-340-3085", "CUSTOMERNUMBER": "67865", "PHASE": "02", "ABDATE": null, "DWGDATE": null, "SHIPWEEK": "08/18/2017", "XDARELEASEDATE": null, "TOTALPRICE": 253.75, "COMPANYNAME": "KWATERSKI BROS. WOOD PRODUCTS", "COMPANYADDRESS": "435 US HIGHWAY 45 S", "Address2": null, "Address3": null, "Address4": null, "COMPANYCITY": "THREE LAKES", "COMPANYSTATE": "WI", "COMPANYZIP": "54562", "COMPANYCOUNTRY": "US" }, { "ORDERNUMBER": "15-P-24347", "Status": "ACTIVE", "PROJECTNAME": "Slumberland Panel Caps", "ReceivedDate": "2016-02-05T00:00:00", "Revision": 0, "CUSTOMERPO": null, "ORDERISFOR": "FABRICATION", "CREDITAPPROVAL": "YES", "SHIPBY": null, "CustomerServiceLocation": "50", "CUSTOMERSERVICERELEASEDATE": null, "ENGINEERINGRELEASEDATE": null, "Contact": "JOHN WANTA", "PHONE": "715 454 6222", "JOBSITESHIPPINGCONTACT": "John Wanta", "JOBSITESHIPPINGPHONE": "715 454 6222", "CUSTOMERNUMBER": "67865", "PHASE": "01", "ABDATE": null, "DWGDATE": null, "SHIPWEEK": "02/18/2016", "XDARELEASEDATE": null, "TOTALPRICE": 422.50, "COMPANYNAME": "SLUMBERLAND", "COMPANYADDRESS": "1631 N STEVENS ST", "Address2": null, "Address3": null, "Address4": null, "COMPANYCITY": "RHINELANDER", "COMPANYSTATE": "WI", "COMPANYZIP": "54501-2126", "COMPANYCOUNTRY": "US" }, { "ORDERNUMBER": "15-P-85915", "Status": "ACTIVE", "PROJECTNAME": "Ringle Project", "ReceivedDate": "2017-05-26T13:24:07", "Revision": 0, "CUSTOMERPO": null, "ORDERISFOR": "FABRICATION", "CREDITAPPROVAL": "YES", "SHIPBY": "CUSTOMER ARRANGED (CPU)", "CustomerServiceLocation": "50", "CUSTOMERSERVICERELEASEDATE": "05/26/2017", "ENGINEERINGRELEASEDATE": null, "Contact": "JOHN WANTA", "PHONE": null, "JOBSITESHIPPINGCONTACT": "JOHN  WANTA", "JOBSITESHIPPINGPHONE": "715-340-3085", "CUSTOMERNUMBER": "67865", "PHASE": "01", "ABDATE": null, "DWGDATE": null, "SHIPWEEK": "06/02/2017", "XDARELEASEDATE": null, "TOTALPRICE": 471.60, "COMPANYNAME": "WANTA BUILDERS", "COMPANYADDRESS": "6875 BROWN LN", "Address2": null, "Address3": null, "Address4": null, "COMPANYCITY": "HATLEY", "COMPANYSTATE": "WI", "COMPANYZIP": "54440-9323", "COMPANYCOUNTRY": "US" }] }';

            var results = JSON.parse(customerOrderJSON);
            
            for (var i = 0; i < results.CustOrders.length; i++) {
                var newRow = table.insertRow(i + 1);
                newRow.setAttribute("id", results.CustOrders[i]["ORDERNUMBER"]);

                var cell1 = newRow.insertCell(0);
                var cell2 = newRow.insertCell(1);
                var cell3 = newRow.insertCell(2);
                var cell4 = newRow.insertCell(3);
                var cell5 = newRow.insertCell(4);

                cell1.innerHTML = "<a href=\"#\" class=\"toggler\" data-orderDetails=\"" + i + "\">+";
                cell2.innerHTML = "" + results.CustOrders[i]["ORDERNUMBER"] + "</br>" + results.CustOrders[i]["PROJECTNAME"];
                cell3.innerHTML = results.CustOrders[i]["ORDERISFOR"];
                cell4.innerHTML = results.CustOrders[i]["Status"];
                cell5.innerHTML = results.CustOrders[i]["ReceivedDate"];
            }
        };
    </script>
    <script>
        function createOrderDetails() {
            var custNbr = "67865";
            var orderNbr = "15-P-24347";
            var brand = "50";

            var table = document.getElementById("customerOrders");

            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 &&
                    this.status == 200) {
                    var results = JSON.parse(this.responseText);


                    for (var i = 0; i < results.CustOrders.length; i++) {
                        var newRow = table.insertRow(i + 1);

                        var cell1 = newRow.insertCell(0);
                        var cell2 = newRow.insertCell(1);
                        var cell3 = newRow.insertCell(2);
                        var cell4 = newRow.insertCell(3);
                        var cell5 = newRow.insertCell(4);

                        cell1.innerHTML = "<a href=\"#\" class=\"toggler\" data-orderDetails=\"" + i + "\">+";
                        cell2.innerHTML = "" + results.CustOrders[i]["ORDERNUMBER"] + "</br>" + results.CustOrders[i]["PROJECTNAME"];
                        cell3.innerHTML = results.CustOrders[i]["ORDERISFOR"];
                        cell4.innerHTML = results.CustOrders[i]["Status"];
                        cell5.innerHTML = results.CustOrders[i]["ReceivedDate"];


                    }
                    return myObj;
                }
            };
            xmlhttp.open("GET", "https://nextgen-crmapi.ncigroupwstest.com/api/GetOrderDetails/"+ custNbr+"/"+orderNbr+"/"+brand+"", true);
            xmlhttp.send();

        }
        }
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $(".toggler").click(function (e) {
                e.preventDefault();
                $('.orderDetails' + $(this).attr('data-orderDetails')).toggle();
                var orderDetailJSON = '{ "ODetails": [{ "ORDERNUMBER": "15-P-24347", "Status": "ACTIVE", "PROJECTNAME": "Slumberland Panel Caps", "ReceivedDate": "2016-02-05T00:00:00", "Revision": 0, "CUSTOMERPO": null, "ORDERISFOR": "FABRICATION", "CREDITAPPROVAL": "YES", "SHIPBY": null, "CustomerServiceLocation": "50", "CUSTOMERSERVICERELEASEDATE": null, "ENGINEERINGRELEASEDATE": null, "Contact": "JOHN WANTA", "PHONE": "715 454 6222", "JOBSITESHIPPINGCONTACT": "John Wanta", "JOBSITESHIPPINGPHONE": "715 454 6222", "CUSTOMERNUMBER": "67865", "PHASE": "01", "ABDATE": null, "DWGDATE": null, "SHIPWEEK": "02/18/2016", "XDARELEASEDATE": null, "TOTALPRICE": 422.50, "COMPANYNAME": "SLUMBERLAND", "COMPANYADDRESS": "1631 N STEVENS ST", "Address2": null, "Address3": null, "Address4": null, "COMPANYCITY": "RHINELANDER", "COMPANYSTATE": "WI", "COMPANYZIP": "54501-2126", "COMPANYCOUNTRY": "US" }] }';

                var results = JSON.parse(orderDetailJSON);

                var nestedTbl = document.createdElement('table');
                nestedTbl.setAttribute("class", "orderDetails0");
                nestedTbl.setAttribute("id", "orderDetails");
                nestedTbl.setAttribute("style", "display:none");

                nestedTbl.insertRow(1);
                var cell1 = nestedTbl.insertCell(0);
                cell1.innerHTML = "test";

            });
        });

    </script>

</head>
<!--onload="customerOrderData()"-->
<body onload="customerOrderDataTest()">

    <table class="customerOrders" id="customerOrders">
        <tr>
            <th></th>
            <th>Orders</th>
            <th>Type</th>
            <th>Status</th>
            <th>Order Date</th>
        </tr>
        <tr>
            <td><a href="#" class="toggler" data-orderDetails="0">+</td>
            <td>16-P-93922<br />4 Walk Doors & Trim</td>
            <td>Component</td>
            <td>Active</td>
            <td>3/8/2019</td>
        </tr>
        <table class="orderDetails0" id="orderDetails" style="display:none">
            <tr>
                <th>Basic Order Information</th>
            </tr>
            <tr>
                <th>Job #:</th>
                <td>16-8-75813</td>
            </tr>
            <tr>
                <th>Order Name:</th>
                <td>Stanton Energy</td>
            </tr>
            <tr></tr>
            <tr>
                <th>Order Date:</th>
                <td>10/12/2018</td>
                <th>Order Is For:</th>
                <td>Approval</td>
                <th>Customer P.O.:</th>
                <td>8804</td>
            </tr>
            <tr>
                <th>Order Type:</th>
                <td>Building</td>
                <th>Credit Approval:</th>
                <td>no</td>
                <th>Ship By: Shared Ride (Piggy Back)</th>
            </tr>
            <tr>
                <th>Order Status:</th>
                <td>Approval</td>
                <th>Total Price:</th>
                <td>$11,056.59</td>
            </tr>
        </table>

        <tr>
            <td></td>
            <td>16-P-88936<br />Brite Red for 16-B-57990 SA i</td>
            <td>Component</td>
            <td>Active</td>
            <td>1/23/2019</td>
        </tr>

    </table>

    <!--
            <table id="orderGrid">
            <tbody>
            <ul id="primaryOrderGrid">
                <li class="caret">
                    <div class="detail"></div>
                    <div class="detail detail-main">
                        <div>
                            <table class="orderGridDetails" id="orderGridDetails">
                                <tr class="orderEntryGrid">
                                    <th>Orders</th>
                                    <th>Type</th>
                                    <th>Status</th>
                                    <th>Order Date</th>
                                </tr>

                                <tr>
                                    <td>16-P-93922<br/>4 Walk Doors & Trim</td>
                                    <td>Component</td>
                                    <td>Active</td>
                                    <td>3/8/2019</td>
                                </tr>
                                <ul class="nested">
                                    <li>
                                        <div>
                                            <table class="orderDetails" id="orderDetails">
                                                <tr>
                                                    <th>Basic Order Information</th>
                                                </tr>
                                                <tr>
                                                    <th>Job #:</th>
                                                    <td>16-8-75813</td>
                                                </tr>
                                                <tr>
                                                    <th>Order Name:</th>
                                                    <td>Stanton Energy</td>
                                                </tr>
                                                <tr></tr>
                                                <tr>
                                                    <th>Order Date:</th>
                                                    <td>10/12/2018</td>
                                                    <th>Order Is For:</th>
                                                    <td>Approval</td>
                                                    <th>Customer P.O.:</th>
                                                    <td>8804</td>
                                                </tr>
                                                <tr>
                                                    <th>Order Type:</th>
                                                    <td>Building</td>
                                                    <th>Credit Approval:</th>
                                                    <td>no</td>
                                                    <th>Ship By: Shared Ride (Piggy Back)</th>
                                                </tr>
                                                <tr>
                                                    <th>Order Status:</th>
                                                    <td>Approval</td>
                                                    <th>Total Price:</th>
                                                    <td>$11,056.59</td>
                                                </tr>
                                            </table>
                                        </div>
                                    </li>
                                </ul>
                                <ul class="nested">
                                    <li>
                                        <div>
                                            <table class="phaseDetails" id="phaseDetails">
                                                <tr>
                                                    <th>Phase</th>
                                                    <th>Stage</th>
                                                    <th>AB Date</th>
                                                    <th>DWG Date</th>
                                                    <th>Ship Week</th>
                                                </tr>
                                                <tr>
                                                    <td>1</td>
                                                    <td>Detailing</td>
                                                    <td>2/4/2019</td>
                                                    <td>2/4/2019</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>3</td>
                                                    <td>Detailing</td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                </tr>
                                            </table>
                                        </div>
                                    </li>
                                </ul>

                                <tr>
                                    <td>16-P-88936<br/>Brite Red for 16-B-57990 SA i</td>
                                    <td>Component</td>
                                    <td>Active</td>
                                    <td>1/23/2019</td>
                                </tr>
                                <ul class="nested">
                                    <li>
                                        <div>
                                            <table class="orderDetails" id="orderDetails">
                                                <tr>
                                                    <th>Basic Order Information</th>
                                                </tr>
                                                <tr>
                                                    <th>Job #:</th>
                                                    <td>16-8-75813</td>
                                                </tr>
                                                <tr>
                                                    <th>Order Name:</th>
                                                    <td>Stanton Energy</td>
                                                </tr>
                                                <tr></tr>
                                                <tr>
                                                    <th>Order Date:</th>
                                                    <td>10/12/2018</td>
                                                    <th>Order Is For:</th>
                                                    <td>Approval</td>
                                                    <th>Customer P.O.:</th>
                                                    <td>8804</td>
                                                </tr>
                                                <tr>
                                                    <th>Order Type:</th>
                                                    <td>Building</td>
                                                    <th>Credit Approval:</th>
                                                    <td>no</td>
                                                    <th>Ship By: Shared Ride (Piggy Back)</th>
                                                </tr>
                                                <tr>
                                                    <th>Order Status:</th>
                                                    <td>Approval</td>
                                                    <th>Total Price:</th>
                                                    <td>$11,056.59</td>
                                                </tr>
                                            </table>
                                        </div>
                                    </li>
                                </ul>
                            </table>
                        </div>
                    </div>
                </li>
            </ul>
            </tbody>
        </table>
        -->

    <script>
        var toggler = document.getElementsByClassName("caret");
        var i;

        for (i = 0; i < toggler.length; i++) {
            toggler[i].addEventListener("click",
                function () {
                    this.parentElement.querySelector(".nested").classList.toggle("active");
                    this.classList.toggle("caret-down");
                });
        }
    </script>
</body>
</html>